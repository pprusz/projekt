import React, {useState, useEffect } from "react";
import { useNavigate } from "react-router-dom";
import { questions } from "./questions";

const MainGame = () => {
  const [counter, setCounter] = useState(1);
  // const [questionIndex, setQuestionIndex] = useState(0);
  // const [currentQuestion, setCurrentQuestion] = useState(questions[0]);
  const [timeLeft, setTimeLeft] = useState(60);
  const navigate = useNavigate();

  const [questionIndex, setQuestionIndex] = useState(0);
  const currentQuestion = questions[questionIndex];

 

  useEffect(() => {
    // setCurrentQuestion(questions[counter]);

    const interval = setInterval(() => {
      setTimeLeft((prevTimeLeft) => {
        if (prevTimeLeft > 0) {
          return prevTimeLeft - 1;
        } else {
          clearInterval(interval);
          return prevTimeLeft;
        }
      });
    }, 1000);

    return () => clearInterval(interval);
  }, []);


const handleAnswer = (answer) => {
  if (answer === currentQuestion.correctAnswer) {
    console.log('dobra odpowiedź!');
    console.log(currentQuestion.currentAnswer);
  }
  else if (answer !== currentQuestion.correctAnswer) {
    console.log('zła odpowiedź!');
    console.log(currentQuestion.correctAnswer)
    console.log(currentQuestion.currentAnswer)
  }
  setQuestionIndex(questionIndex + 1);
  setCounter(counter + 1);
};

//  const handleAnswerClick = (index, answer) => {
//   const answerElements = document.querySelectorAll('.answer');

//   if (currentQuestion.selectedAnswer === index) {
//     setCurrentQuestion({
//       ...currentQuestion,
//       selectedAnswer: null,
//     });
//   } else {
//     setCurrentQuestion({
//       ...currentQuestion,
//       selectedAnswer: index,
//       currentAnswer: answer
//     });
//     for (let i = 0; i < answerElements.length; i++) {
//       if (i===index){
//         answerElements[i].classList.add("selected")

//       }
//     }
//   }
// };

const handleAnswerCheck = () => {
  if (currentQuestion.correctAnswer === currentQuestion.currentAnswer) {
    // setQuestionIndex(questionIndex + 1);
    setCurrentQuestion(questions[+1])
    setCounter(counter + 1);
    console.log('dobra odpowiedź!');
    console.log(currentQuestion.currentAnswer);
  } 
  else {
    // navigate("/bad");
    console.log('zła odpowiedź!')
    console.log(currentQuestion.correctAnswer)
    console.log(currentQuestion.currentAnswer)
  }
};




  return (
    <div className="game_container">
      <div className="game_container_question_counter">
        <div className="game_container_question_counter_element">{counter}</div>
      </div>

      <div className="game_container_main">
        <div className="game_container_main_question">{currentQuestion.question}</div>
        <div className="game_container_main_answers">
          {currentQuestion.answers.map((answer, index) => (
            <div
              className={`answer ${currentQuestion.selectedAnswer === index ? "selected" : ""}`}
              key={index}
              onClick={handleAnswer}
            >
              {answer}
            </div>
          ))}
</div>
      </div>

      <div className="game_container_buttons">

        <div className="game_container_buttons_help">

          <button className="game_container_buttons_help_fifty">
            50:50
            <span className="tooltip">Usuń dwie błędne odpowiedzi</span>
            </button>

          <button className="game_container_buttons_help_public">
            <span className="fas fa-user"></span>
            <span className="tooltip">Zapytaj publiczność</span>
            </button>

          <button className="game_container_buttons_help_change">
            <span className="fas fa-arrow-right"></span>
            <span className="tooltip">Zmień pytanie</span>
            </button>

        </div>


        <div className="game_container_buttons_clock"><span>{timeLeft}</span></div>


        <div className="game_container_buttons_check">
          <button onClick={handleAnswerCheck} className="game_container_buttons_check_button">Sprawdź odpowiedź</button>
        </div>
      </div>
    </div>
  );
};

export { MainGame };